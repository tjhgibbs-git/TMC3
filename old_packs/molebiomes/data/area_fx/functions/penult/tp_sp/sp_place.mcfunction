# places the spawner
setblock ~ ~ ~ minecraft:spawner{Delay:300s,MaxNearbyEntities:3s,MaxSpawnDelay:900s,MinSpawnDelay:600s,RequiredPlayerRange:20s,SpawnCount:5s,SpawnData:{ActiveEffects:[{Amplifier:0b,Duration:100000,Id:14b,ShowParticles:0b}],Attributes:[{Base:0,Name:"generic.max_health"}],Health:0.0f,Lifetime:2400,Passengers:[{ArmorDropChances:[0.085f,0.085f,-327.67f,-327.67f],ArmorItems:[{},{},{Count:1b,id:"minecraft:leather_chestplate",tag:{display:{color:0}}},{Count:1b,id:"minecraft:player_head",tag:{SkullOwner:{Id:[I;1743339431,-2145827637,-1613830475,-1422466752],Properties:{textures:[{Value:"eyJ0ZXh0dXJlcyI6eyJTS0lOIjp7InVybCI6Imh0dHA6Ly90ZXh0dXJlcy5taW5lY3JhZnQubmV0L3RleHR1cmUvOTllMDFiM2EzNWFlM2JlNDQ4M2I2ZGY2OWI3MDcwYmQ2ZGM3NWIzOTlkN2UyZWJiYzdiODg0MDMzMmY3YjNhMCJ9fX0="}]}}}}],Attributes:[{Base:12,Name:"generic.max_health"},{Base:0.28d,Name:"generic.movement_speed"}],HandDropChances:[-327.67f,-327.67f],HandItems:[{Count:1b,id:"minecraft:netherite_sword"},{Count:1b,id:"minecraft:netherite_sword"}],Health:12.0f,Tags:["Spawned"],id:"minecraft:wither_skeleton"}],PlayerSpawned:0b,Tags:["Spawned"],id:"minecraft:endermite"},SpawnPotentials:[{Entity:{ActiveEffects:[{Amplifier:0b,Duration:100000,Id:14b,ShowParticles:0b}],Attributes:[{Base:0,Name:"generic.max_health"}],Health:0.0f,Lifetime:2400,Passengers:[{ArmorDropChances:[0.085f,0.085f,-327.67f,-327.67f],ArmorItems:[{},{},{Count:1b,id:"minecraft:leather_chestplate",tag:{display:{color:0}}},{Count:1b,id:"minecraft:player_head",tag:{SkullOwner:{Id:[I;1743339431,-2145827637,-1613830475,-1422466752],Properties:{textures:[{Value:"eyJ0ZXh0dXJlcyI6eyJTS0lOIjp7InVybCI6Imh0dHA6Ly90ZXh0dXJlcy5taW5lY3JhZnQubmV0L3RleHR1cmUvOTllMDFiM2EzNWFlM2JlNDQ4M2I2ZGY2OWI3MDcwYmQ2ZGM3NWIzOTlkN2UyZWJiYzdiODg0MDMzMmY3YjNhMCJ9fX0="}]}}}}],Attributes:[{Base:12,Name:"generic.max_health"},{Base:0.28d,Name:"generic.movement_speed"}],HandDropChances:[-327.67f,-327.67f],HandItems:[{Count:1b,id:"minecraft:netherite_sword"},{Count:1b,id:"minecraft:netherite_sword"}],Health:12.0f,Tags:["Spawned"],id:"minecraft:wither_skeleton"}],PlayerSpawned:0b,Tags:["Spawned"],id:"minecraft:endermite"},Weight:3},{Entity:{ActiveEffects:[{Amplifier:0b,Duration:100000,Id:14b,ShowParticles:0b}],Attributes:[{Base:0,Name:"generic.max_health"}],Health:0.0f,Lifetime:2400,Passengers:[{ArmorDropChances:[-327.67f,-327.67f,-327.67f,-327.67f],ArmorItems:[{Count:1b,id:"minecraft:iron_boots"},{Count:1b,id:"minecraft:iron_leggings"},{Count:1b,id:"minecraft:iron_chestplate"},{Count:1b,id:"minecraft:end_stone_bricks"}],Attributes:[{Base:30,Name:"generic.max_health"},{Base:0.9d,Name:"generic.knockback_resistance"},{Base:0.19d,Name:"generic.movement_speed"},{Base:12,Name:"generic.attack_damage"}],Health:30.0f,Silent:1b,Tags:["Spawned"],id:"minecraft:zombie"}],PlayerSpawned:0b,Tags:["Spawned"],id:"minecraft:endermite"},Weight:1}],SpawnRange:4s} destroy
# say placing spawner

# gets the spawn delay from the spawner before it was broken and data modifies the new spawner to have the same delay. If not possible to do that, it defaults to 300 ticks
data remove storage mole:tp_sp sp_delay
execute if score @p spawnerdelay matches 0..2147483647 store result storage mole:tp_sp sp_delay short 1 run scoreboard players get @p spawnerdelay
execute if data storage mole:tp_sp sp_delay run data modify block ~ ~ ~ Delay set from storage mole:tp_sp sp_delay

#stops the spawnerbreak sound and plays the teleport sound
stopsound @a[distance=..20] * minecraft:block.metal.break
playsound minecraft:entity.shulker.teleport hostile @a ~ ~ ~ 10 1

#adds a tag to the marker so that the spawner can't return there
tag @s add donebefore 
